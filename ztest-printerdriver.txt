function Test-PrinterDriver {
    param([string]$Name)
    
    try {
        $driver = Get-PrinterDriver -Name $Name -ErrorAction Stop
        return $true
    }
    catch {
        return $false
    }
}

function Test-PrinterPort {
    param([string]$Name)
    
    try {
        $port = Get-PrinterPort -Name $Name -ErrorAction Stop
        return $true
    }
    catch {
        return $false
    }
}

function Get-PrintUICommands {
    Write-Host "`nAlternative installation methods:" -ForegroundColor Cyan
    
    # Method 1: Using PrintUI
    Write-Host "1. Using PrintUI.dll:" -ForegroundColor Yellow
    Write-Host "   rundll32 printui.dll,PrintUIEntry /if /b `"$PrinterName`" /f `"$InfFilePath`" /r `"$portName`" /m `"$DriverName`"" -ForegroundColor White
    
    # Method 2: Using pnputil for driver only
    Write-Host "2. Driver only installation:" -ForegroundColor Yellow
    Write-Host "   pnputil /add-driver `"$InfFilePath`"" -ForegroundColor White
}